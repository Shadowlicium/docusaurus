"use strict";(self.webpackChunkprojet_docu=self.webpackChunkprojet_docu||[]).push([[854],{1519:(e,r,n)=>{n.r(r),n.d(r,{assets:()=>o,contentTitle:()=>c,default:()=>u,frontMatter:()=>l,metadata:()=>s,toc:()=>d});const s=JSON.parse('{"id":"ADDS/NFS","title":"NFS","description":"Le serveur NFS partagera les m\xeames ressources que le serveur samba-adds","source":"@site/docs/ADDS/NFS.md","sourceDirName":"ADDS","slug":"/ADDS/NFS","permalink":"/docusaurus/docs/ADDS/NFS","draft":false,"unlisted":false,"editUrl":"https://github.com/Shadowlicium/docusaurus/docs/ADDS/NFS.md","tags":[],"version":"current","sidebarPosition":6,"frontMatter":{"sidebar_position":6},"sidebar":"tutorialSidebar","previous":{"title":"samba-adds","permalink":"/docusaurus/docs/ADDS/samba-adds"},"next":{"title":"AWS","permalink":"/docusaurus/docs/ADDS/AWS"}}');var i=n(4848),t=n(8453);const l={sidebar_position:6},c=void 0,o={},d=[{value:"1. Installer les paquets NFS",id:"1-installer-les-paquets-nfs",level:2},{value:"2. Configurer le serveur NFSv4",id:"2-configurer-le-serveur-nfsv4",level:2},{value:"-Cr\xe9er le point d&#39;export principal (root NFS)",id:"-cr\xe9er-le-point-dexport-principal-root-nfs",level:4},{value:"-Configurer les exports NFS",id:"-configurer-les-exports-nfs",level:4},{value:"3. Appliquer les changements et activer NFSv4",id:"3-appliquer-les-changements-et-activer-nfsv4",level:2},{value:"4. Configurer le pare-feu (si activ\xe9)",id:"4-configurer-le-pare-feu-si-activ\xe9",level:2},{value:"5. Monter le partage NFSv4 sur le client",id:"5-monter-le-partage-nfsv4-sur-le-client",level:2},{value:"6. S\xe9curiser davantage NFSv4",id:"6-s\xe9curiser-davantage-nfsv4",level:2},{value:"V\xe9rification",id:"v\xe9rification",level:2}];function a(e){const r={code:"code",h2:"h2",h4:"h4",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,t.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(r.p,{children:"Le serveur NFS partagera les m\xeames ressources que le serveur samba-adds"}),"\n",(0,i.jsx)(r.h2,{id:"1-installer-les-paquets-nfs",children:"1. Installer les paquets NFS"}),"\n",(0,i.jsxs)(r.p,{children:["Sur le ",(0,i.jsx)(r.strong,{children:"serveur"})," :"]}),"\n",(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{children:"sudo apt update\nsudo apt install nfs-kernel-server\n"})}),"\n",(0,i.jsxs)(r.p,{children:["sur le ",(0,i.jsx)(r.strong,{children:"client"})]}),"\n",(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{children:"sudo apt install nfs-common\n"})}),"\n",(0,i.jsx)(r.h2,{id:"2-configurer-le-serveur-nfsv4",children:"2. Configurer le serveur NFSv4"}),"\n",(0,i.jsx)(r.h4,{id:"-cr\xe9er-le-point-dexport-principal-root-nfs",children:"-Cr\xe9er le point d'export principal (root NFS)"}),"\n",(0,i.jsx)(r.p,{children:"NFSv4 utilise un point d'ancrage hnique. Cr\xe9ez un dossier d\xe9di\xe9 :"}),"\n",(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{children:"sudo mkdir -p /srv/nfs/share\n"})}),"\n",(0,i.jsx)(r.p,{children:"D\xe9finir les permissions :"}),"\n",(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{children:"sudo chown -R nobody:nogroup /srv/nfs\nsudo chmod 755 /srv/nfs\nsudo chmod 777 /srv/nfs/share\n"})}),"\n",(0,i.jsx)(r.h4,{id:"-configurer-les-exports-nfs",children:"-Configurer les exports NFS"}),"\n",(0,i.jsx)(r.p,{children:"Ouvrir le fichier de configuration :"}),"\n",(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{children:"sudo nano /etc/exports\n"})}),"\n",(0,i.jsx)(r.p,{children:"Ajouter cette ligne pour un partage s\xe9curis\xe9 :"}),"\n",(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{children:"/srv/nfs4 192.168.1.0/24(ro,fsid=0,no_subtree_check,async)\n/srv/nfs4/share 192.168.1.0/24(rw,no_subtree_check,async)\n"})}),"\n",(0,i.jsx)(r.h2,{id:"3-appliquer-les-changements-et-activer-nfsv4",children:"3. Appliquer les changements et activer NFSv4"}),"\n",(0,i.jsx)(r.p,{children:"Activer NFSv4 en ajustant le fichier de configuration :"}),"\n",(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{children:"sudo nano /etc/default/nfs-kernel-server\n"})}),"\n",(0,i.jsx)(r.p,{children:"Ajouter"}),"\n",(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{children:'RPCNFSDOPTS="--nfs-version 4"\n'})}),"\n",(0,i.jsx)(r.p,{children:"Recharger les exports et red\xe9marrez le service :"}),"\n",(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{children:"sudo exportfs -rav\nsudo systemctl restart nfs-server\nsudo systemctl enable nfs-server\n"})}),"\n",(0,i.jsx)(r.h2,{id:"4-configurer-le-pare-feu-si-activ\xe9",children:"4. Configurer le pare-feu (si activ\xe9)"}),"\n",(0,i.jsx)(r.p,{children:"Autoriser le trafic NFS :"}),"\n",(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{children:"sudo ufw allow from x.x.x.x/24 to any port nfs\nsudo ufw reload\n"})}),"\n",(0,i.jsx)(r.h2,{id:"5-monter-le-partage-nfsv4-sur-le-client",children:"5. Monter le partage NFSv4 sur le client"}),"\n",(0,i.jsx)(r.p,{children:"Cr\xe9er un dossier local pour monter le partage :"}),"\n",(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{children:"sudo mkdir -p /mnt/nfs_share\n"})}),"\n",(0,i.jsx)(r.p,{children:"Monter le partage sur votre client:"}),"\n",(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{children:"sudo mount -t nfs -o vers=4 x.x.x.x:/share /mnt/nfs4_share\n"})}),"\n",(0,i.jsx)(r.p,{children:"(remplacer x.x.x.x par l'ip de votre serveur NFS)"}),"\n",(0,i.jsxs)(r.p,{children:["Pour un montage automatique au d\xe9marrage, ajouter cette ligne dans ",(0,i.jsx)(r.strong,{children:"/etc/fstab"})," :"]}),"\n",(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{children:"x.x.x.x:/share /mnt/nfs4_share nfs4 defaults 0 0\n"})}),"\n",(0,i.jsx)(r.h2,{id:"6-s\xe9curiser-davantage-nfsv4",children:"6. S\xe9curiser davantage NFSv4"}),"\n",(0,i.jsxs)(r.ul,{children:["\n",(0,i.jsx)(r.li,{children:"Limiter les acc\xe8s en restreignant les IPs autoris\xe9es dans /etc/exports."}),"\n",(0,i.jsx)(r.li,{children:"Activer Kerberos afin d'autoriser l'authentificiation obligatoire en utilisant NFSv4"}),"\n",(0,i.jsx)(r.li,{children:"Verrouiller les permission avec chmod et chown afin de restreindre l'acc\xe8s de certain document/fichier a des utilisateur/groupe."}),"\n"]}),"\n",(0,i.jsx)(r.h2,{id:"v\xe9rification",children:"V\xe9rification"}),"\n",(0,i.jsx)(r.p,{children:"Sur le serveur :"}),"\n",(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{children:"sudo exportfs -v\n"})}),"\n",(0,i.jsx)(r.p,{children:"Sur le client :"}),"\n",(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{children:"mount | grep nfs\n"})})]})}function u(e={}){const{wrapper:r}={...(0,t.R)(),...e.components};return r?(0,i.jsx)(r,{...e,children:(0,i.jsx)(a,{...e})}):a(e)}},8453:(e,r,n)=>{n.d(r,{R:()=>l,x:()=>c});var s=n(6540);const i={},t=s.createContext(i);function l(e){const r=s.useContext(t);return s.useMemo((function(){return"function"==typeof e?e(r):{...r,...e}}),[r,e])}function c(e){let r;return r=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:l(e.components),s.createElement(t.Provider,{value:r},e.children)}}}]);